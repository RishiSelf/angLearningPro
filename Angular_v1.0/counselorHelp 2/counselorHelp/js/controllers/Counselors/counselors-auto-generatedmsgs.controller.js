as.controller('counselorAutoGeneratedMsgController', function($scope, $rootScope, Counselors, $stateParams, Main) {
	
	$scope.msgDisabled = true;
	$scope.stateChange();
	Counselors.getGeneratedMessage({'counselor_id':$stateParams.id}).success(function (response) {
		// console.log(JSON.stringify(response))
        if(response.status == 'success') {
        	$scope.message = response.data.CounselorMessage.message;
        } 
        // else {
        // 	$scope.message = 'Hej! V&auml;lkommen och tack f&ouml;r att du valt att arbeta med mig. Under n&auml;rmaste veckan kommer v&aring;rt arbete handla om att jag ska l&auml;ra k&auml;nna dig b&auml;ttre och du ska f&aring; en uppfattning hur n&auml;tterapi fungerar. Till att b&ouml;rja med skulle jag uppskatta om du kan besvara n&aring;gra fr&aring;gor om dig sj&auml;lv och dina sv&aring;righeter. N&auml;r jag tagit del av svaren p&aring;b&ouml;rjar vi v&aring;r konversation i terapirummet. Mot slutet av veckan kommer vi diskutera om du vill forts&auml;tta med din terapi eller avsluta kostnadsfritt. &Auml;n en g&aring;ng v&auml;lkommen, jag ser fram emot att f&aring; l&auml;ra k&auml;nna dig! ';
        // } 

    }).error(function (error) {
        Main.popupCommonFunction('apiError');
    });

	$scope.submitMsg = function(message){

		if(message == 'cancel'){
			$scope.msgDisabled = false;

		} else {

			Counselors.postGeneratedMessage({'counselor_id':$stateParams.id,'message':message}).success(function (response) {			
				if(response.status == 'success') {
					$scope.msgDisabled = true;
					Main.popupCommonFunction('autoGenerated');
				}
				
		    }).error(function (error) {
		        Main.popupCommonFunction('apiError');
		    });
		}		
	}
});